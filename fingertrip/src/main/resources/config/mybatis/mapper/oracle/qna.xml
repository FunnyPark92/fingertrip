<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.qna">
	<select id="selectAll" resultType="QnAVO">
		select * from qna
		order by qna_no
	</select>
	
	<select id="selectAllNotice" parameterType="SearchVo" resultType="NoticeVo">
		select *
		from (
			select list.*, rownum as RNUM
			from(
				select * from notice 
				<if test="searchKeyword!=null and searchKeyword!=''">
					where ${searchCondition} like '%' || #{searchKeyword} || '%'
				</if>
				order by notice_no desc
				)list
			)
		<![CDATA[
		where RNUM>${firstRecordIndex} and RNUM<=${firstRecordIndex}+${recordCountPerPage}
		]]>
	</select>
	
	<select id="totalRecord" resultType="int" parameterType="SearchVo">
		select count(*)
		from notice
		<if test="searchKeyword!=null and searchKeyword!=''">
			where ${searchCondition} like '%' || #{searchKeyword} || '%'
		</if>
	</select>
	
	<update id="countUpdate" parameterType="int">
		update qna
		set read_count=read_count+1
		where qna_no=#{qnaNo}
	</update>
	
	<update id="countUpdateNotice" parameterType="int">
		update notice 
		set read_count=read_count+1
		where notice_no=#{noticeNo}
	</update>
</mapper>









