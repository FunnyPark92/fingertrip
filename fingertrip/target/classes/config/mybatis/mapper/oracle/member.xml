<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.member">
	<insert id="insertMember" parameterType="MemberVO">
		INSERT INTO MEMBER(MEMBER_NO, NAME, ID, PASSWORD, EMAIL1, EMAIL2, 
						HP1, HP2, HP3, ZIPCODE, ADDRESS, ADDRESS_DETAIL, GENDER, MAIL_AGREEMENT)
		VALUES(MEMBER_SEQ.NEXTVAL, #{name}, #{id}, #{password}, #{email1}, #{email2},
			 #{hp1}, #{hp2}, #{hp3}, #{zipcode}, #{address}, #{addressDetail}, #{gender}, #{mailAgreement})
	</insert>
	
	<select id="selectDbPwd" parameterType="string" resultType="string">
		SELECT PASSWORD FROM MEMBER WHERE ID=#{id} AND OUT_DATE IS NULL 
	</select>
	
	<select id="findId" parameterType="MemberVo" resultType="string">
		select id from member
		where name=#{name} and email1=#{email1} and email2=#{email2}
	</select>
	
	<select id="findPwCnt" parameterType="MemberVo" resultType="int">
		select count(*) from member
		where id=#{id} and email1=#{email1} and email2=#{email2}
	</select>
	
	<update id="updatePw" parameterType="MemberVo">
		update member
		set password=#{password}
		where id=#{id} and email1=#{email1} and email2=#{email2}
	</update>
	
	<update id="memberOut" parameterType="MemberVo">
		update member
		set out_date=sysdate, 
			<![CDATA[
			out_reason_no=case when 0<#{outReasonNo} then #{outReasonNo}
			]]>
		   						else null end
		where id=#{id}
	</update>
	
	<update id="memberLogOut" parameterType="String">
		update member set logout_date = sysdate where id =#{id}
	</update>
	
	<select id="userCheckId" parameterType="String" resultType="int">
		select count(*) from member where id =#{id}
	</select>
	
	<update id="emailAuth" parameterType="String">
		update member set mail_authen = 'Y' where id= #{id}
	</update>
	
	<select id="checkMail" parameterType="String" resultType="int">
		select count(*) from member where id=#{id} and mail_authen ='N'
	</select>
   
   <update id="memberEdit" parameterType="memberVo">
   		update member set password = #{password}, hp1=#{hp1}, hp2=#{hp2},hp3=#{hp3}, zipcode = #{zipcode},address=#{address} ,address_detail = #{addressDetail} 
   		where id= #{id}
   </update>
	
	<select id="logingMember" parameterType="String" resultType="MemberVo">
		select * from member where id=#{id}
	</select>
	
</mapper>









